{% extends 'core.html' %}
{% block content %}

<div class="container">
    <div class="read-posts">
        
    
 
         {% for item in post %}
         <div class="post">
             
             <div class="post-header">
                 <div class='title'><A>{{item.title}} <i class="fas fa-star"></i> {{item.post_rating}}</A></div>
                 <div class='autor-date'>{{item.publish_date}} / {{item.user}}</div>
                <div><span id="edit-post"><i class="fas fa-edit"></i></span></div>
             </div>
             <div class="post-content">
                
                 <p>{{item.text}}</p>
                
                 
             
             </div>
             <div class="post-footer">
                 <div class="comments">

                     <div class='add-comment'>
                         <a>ADD COMMENT</a> 
                     </div> 

                     <div class='add-comment-input'>
                         <form action="{% url 'add_comment' %}" method="post">
                             {% csrf_token %}
                             <input type='hidden' name='post_id' value="{{item.id}}"/>
                            <textarea name="text"></textarea>
                            <button>ADD</button>
                            
                         </form>
                    </div>
                 </div>
                 
                 <div class="rate">
                      
                    <form method="post" action="{% url 'add_rating' %}">
                        {% csrf_token %}
                        
                     <input type='hidden' name='post_id' value="{{item.id}}"/>
                     <input type="radio" class='star' id="star5" name="rating" value="5" />
                     <label for="star5" title="text">5 stars</label>
                     <input type="radio" class='star' id="star4" name="rating" value="4" />
                     <label for="star4" title="text">4 stars</label>
                     <input type="radio" class='star' id="star3" name="rating" value="3" />
                     <label for="star3" title="text">3 stars</label>
                     <input type="radio" class='star' id="star2" name="rating" value="2" />
                     <label for="star2" title="text">2 stars</label>
                     <input type="radio"  class='star' id="star1" name="rating" value="1" />
                     <label for="star1" title="text">1 star</label>
                       
                     
                       
                    
                 </div>
                 <button id="rate">RATE</button>
                </form>
             </div>
             
            <div class='comment'>
                <ul>
                    <li class="comment-date-user">21/03/2021 / Danielowy<span id="edit-comment"><i class="fas fa-edit"></i></span></li>
                    <li class="comment-content">Oto przyk≈Çadowy komentarz dla tego posta.</li>

                </ul>
            </div>
            
            {% for comment in comments %}

            <div class='comment'>
                <ul>
                    <li class="comment-date-user">{{comment.publish_date}} / {{comment.user}}<span id="edit-comment"><i class="fas fa-edit"></i></span></li>
                    <li class="comment-content">{{comment.text}}</li>

                </ul>
            </div>

            {% endfor %}

         </div>

          <div class="edit-post-content">
            <div class="edit-post-content-div"><span id="close-edit-post">X</span>
              <h3 style='letter-spacing: 2;'>EDIT POST HERE </h3>
                <form class="post-edit" action="{% url 'edit_post' %}" method="post">
                {% csrf_token %}
                  <input type="hidden" name="post_id" value="{{item.id}}"/>
                  <textarea name="text" class="post-edit-textarea">{{ item.text }}</textarea>
                  <button id="submit-post"type="submit"><i class="fas fa-plus"></i></button>
                </form>
            </div>
          </div>      


         <div class="edit-comment-content">
            <div class="edit-comment-content-div"><span id="close-edit-comment">X</span>
              <h3 style='letter-spacing: 2;'>EDIT COMMENT HERE </h3>
                <form class="post-comment-edit" action="{% url 'edit_comment' %}" method="post">
                {% csrf_token %}
                  <input type="hidden" name="post_id" value="{{item.id}}"/>
                  <textarea name="text" class="comment-edit-textarea">{{ comment.text }}</textarea>
                  <button type="submit"><i class="fas fa-plus"></i></button>
                </form>
            </div>
          </div>      

         {% endfor %}
    </div>
 </div>

<script>

addCommentButton = document.querySelectorAll('.add-comment');
commentDiv = document.querySelectorAll('.add-comment-input');

addCommentButton[0].addEventListener('click', function(){
    addCommentButton[0].style.display='none';
    commentDiv[0].style.display="flex";
    
});
    
commentsWidth = document.querySelectorAll('.comments'); 
buttonRate = document.querySelectorAll('#rate'); 
star = document.querySelectorAll('.star'); 

for(let i=0; i<star.length; i++){
star[i].addEventListener('click', function(){

    buttonRate[0].style.display="block";
    commentsWidth[0].style.width="645";
});
}
var editCommentDiv = document.querySelectorAll(".edit-comment-content");
var closeEditComment = document.querySelectorAll("#close-edit-comment");
var editCommentButton = document.querySelectorAll("#edit-comment");

for(let o=0; o<editCommentButton.length; o++){
  function openEditCommentDiv(){
    if(editCommentDiv[o].style.display !== "block"){
  editCommentDiv[o].style.display="block";
  }
}
function closeEditCommentDiv(){
  if(editCommentDiv[o].style.display !== "none"){
  editCommentDiv[o].style.display="none";
  }
}
  editCommentButton[o].addEventListener('click', openEditCommentDiv, false);
  closeEditComment[o].addEventListener('click', closeEditCommentDiv, false);
}

var editPostDiv = document.querySelectorAll(".edit-post-content");
var closeEditPost = document.querySelectorAll("#close-edit-post");
var editPostButton = document.querySelectorAll("#edit-post");

for(let h=0; h<editPostDiv.length; h++){

    function openEditPostDiv(){
        if(editPostDiv[h].style.display !== "block"){
            editPostDiv[h].style.display="block";
      }
    }
    function closeEditPostDiv(){
      if(editPostDiv[h].style.display !== "none"){
        editPostDiv[h].style.display="none";
      }
    }
    editPostButton[h].addEventListener('click', openEditPostDiv, false);
      closeEditPost[h].addEventListener('click', closeEditPostDiv, false); 


}
</script>
{% endblock content %}